@page "/book/{BookID:int}"

@inject BookService BookService
@using Bookshelved.Services
@using Bookshelved.Core.DTOs.Book

<div class="container">
    @if (BookDetail == null)
    {
        <p><em>Loading...</em></p>
    }
    else
    {
        <h1>Viewing @BookDetail.Name</h1>
        <h2>By: @BookDetail.Author.Forename @BookDetail.Author.Surname</h2>
                    
        @foreach (var review in @BookDetail.Reviews)
        {
            <p>@review.User.Username says:</p>
            <ul>
                <li>Rating: @review.Rating / 5</li>
                <li>Comment: @review.Comment</li>
            </ul>
        }                                                              
    }
</div>

@code {
    [Parameter]
    public int BookID { get; set; }

    public BookDetailsDTO BookDetail { get; set; }

    protected override async Task OnInitializedAsync()
    {
        BookDetail = await BookService.GetBookDetails(BookID);
    }
} 